{
	"info": {
		"name": "Yawmiy Backend API",
		"description": "Collection for testing Yawmiy Backend endpoints",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Health Check",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:3000",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000"
				}
			}
		},
		{
			"name": "Register Student",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"student@university.edu\",\n  \"password\": \"Password123!\",\n  \"student_id\": \"12345678\",\n  \"name\": \"John Doe\"\n}"
				},
				"url": {
					"raw": "http://localhost:3000/auth/register",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"auth",
						"register"
					]
				}
			}
		},
		{
			"name": "Login",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"student@university.edu\",\n  \"password\": \"Password123!\"\n}"
				},
				"url": {
					"raw": "http://localhost:3000/auth/login",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"auth",
						"login"
					]
				}
			}
		},
		{
			"name": "Validate Token",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer YOUR_TOKEN_HERE",
						"description": "Replace YOUR_TOKEN_HERE with the token from login response"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"url": {
					"raw": "http://localhost:3000/auth/validate-token",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"auth",
						"validate-token"
					]
				}
			}
		},
		{
			"name": "Listings",
			"item": [
				{
					"name": "Browse Listings",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:3000/listings?category=Textbooks&price_min=0&price_max=100000&sort=price_asc",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"listings"
							],
							"query": [
								{
									"key": "category",
									"value": "Textbooks",
									"description": "Textbooks, Electronics, Furniture, Clothing, Sports, Stationery, Snacks, Beverages, Other"
								},
								{
									"key": "price_min",
									"value": "0",
									"description": "Minimum price in paise"
								},
								{
									"key": "price_max",
									"value": "100000",
									"description": "Maximum price in paise (100000 = ₹1000)"
								},
								{
									"key": "condition",
									"value": "new",
									"description": "new, like_new, good, fair",
									"disabled": true
								},
								{
									"key": "sort",
									"value": "price_asc",
									"description": "price_asc, price_desc, date_desc, date_asc"
								}
							]
						}
					}
				},
				{
					"name": "Get Listing Details",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:3000/listings/:id",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"listings",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "YOUR_LISTING_ID_HERE",
									"description": "UUID of the listing"
								}
							]
						}
					}
				},
				{
					"name": "Create Listing",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Calculus Textbook - 3rd Edition\",\n  \"category\": \"Textbooks\",\n  \"price\": 50000,\n  \"condition\": \"like_new\",\n  \"description\": \"Excellent condition calculus textbook. Barely used, no highlights or notes.\",\n  \"photos\": [\"https://example.com/photo1.jpg\"],\n  \"location\": \"Main Campus - Building A\"\n}"
						},
						"url": {
							"raw": "http://localhost:3000/listings",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"listings"
							]
						}
					}
				},
				{
					"name": "Update Listing",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"price\": 45000,\n  \"description\": \"Updated description - Price reduced!\"\n}"
						},
						"url": {
							"raw": "http://localhost:3000/listings/:id",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"listings",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "YOUR_LISTING_ID_HERE",
									"description": "UUID of the listing"
								}
							]
						}
					}
				},
				{
					"name": "Delete Listing",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/listings/:id",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"listings",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "YOUR_LISTING_ID_HERE",
									"description": "UUID of the listing"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "Orders",
			"item": [
				{
					"name": "Create Order",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"listing_id\": \"YOUR_LISTING_ID_HERE\",\n  \"meeting_location\": \"Main Campus - Building A\"\n}"
						},
						"url": {
							"raw": "http://localhost:3000/orders",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"orders"
							]
						}
					}
				},
				{
					"name": "Get All Orders",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/orders",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"orders"
							]
						}
					}
				},
				{
					"name": "Get Order Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/orders/:order_id",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"orders",
								":order_id"
							],
							"variable": [
								{
									"key": "order_id",
									"value": "YOUR_ORDER_ID_HERE",
									"description": "UUID of the order"
								}
							]
						}
					}
				},
				{
					"name": "Initiate PhonePe Payment",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/orders/:order_id/payment",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"orders",
								":order_id",
								"payment"
							],
							"variable": [
								{
									"key": "order_id",
									"value": "YOUR_ORDER_ID_HERE",
									"description": "UUID of the order"
								}
							]
						}
					}
				},
				{
					"name": "Complete Order",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"meeting_time\": \"2026-01-15T10:00:00Z\"\n}"
						},
						"url": {
							"raw": "http://localhost:3000/orders/:order_id/complete",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"orders",
								":order_id",
								"complete"
							],
							"variable": [
								{
									"key": "order_id",
									"value": "YOUR_ORDER_ID_HERE",
									"description": "UUID of the order"
								}
							]
						}
					}
				},
				{
					"name": "Test PhonePe Webhook (Success)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": "Required"
							},
							{
								"key": "x-verify",
								"value": "test_signature_123###1",
								"description": "PhonePe signature header (placeholder for testing)"
							},
							{
								"key": "authorization",
								"value": "test_auth_header",
								"description": "Authorization header for SDK validation (placeholder for testing)"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"code\": \"PAYMENT_SUCCESS\",\n  \"message\": \"Payment successful\",\n  \"data\": {\n    \"merchantId\": \"M232G4O6KU7K2_2601012107\",\n    \"merchantTransactionId\": \"YOUR_ORDER_ID_HERE\",\n    \"transactionId\": \"TXN123456789\",\n    \"amount\": 55825,\n    \"state\": \"COMPLETED\",\n    \"responseCode\": \"PAYMENT_SUCCESS\",\n    \"paymentInstrument\": {\n      \"type\": \"UPI\"\n    }\n  }\n}"
						},
						"url": {
							"raw": "http://localhost:3000/orders/webhook",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"orders",
								"webhook"
							]
						},
						"description": "Test PhonePe webhook for successful payment. Replace YOUR_ORDER_ID_HERE with actual order_id. This simulates PhonePe sending a webhook after payment success. Order status will change to 'escrowed'."
					}
				},
				{
					"name": "Test PhonePe Webhook (Failed)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "x-verify",
								"value": "test_signature_123###1"
							},
							{
								"key": "authorization",
								"value": "test_auth_header"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"code\": \"PAYMENT_FAILED\",\n  \"message\": \"Payment failed\",\n  \"data\": {\n    \"merchantId\": \"M232G4O6KU7K2_2601012107\",\n    \"merchantTransactionId\": \"YOUR_ORDER_ID_HERE\",\n    \"transactionId\": \"TXN123456789\",\n    \"amount\": 55825,\n    \"state\": \"FAILED\",\n    \"responseCode\": \"PAYMENT_FAILED\",\n    \"paymentInstrument\": {\n      \"type\": \"UPI\"\n    }\n  }\n}"
						},
						"url": {
							"raw": "http://localhost:3000/orders/webhook",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"orders",
								"webhook"
							]
						},
						"description": "Test PhonePe webhook for failed payment. Replace YOUR_ORDER_ID_HERE with actual order_id. Order status will remain 'pending'."
					}
				}
			]
		},
		{
			"name": "Scouts",
			"item": [
				{
					"name": "Register as Scout",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login. User must have 1+ completed transactions."
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}"
						},
						"url": {
							"raw": "http://localhost:3000/scouts/register",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"scouts",
								"register"
							]
						},
						"description": "Register as a scout. Requires user to have at least 1 completed transaction (as buyer or seller)."
					}
				},
				{
					"name": "Get Scout Earnings",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/scouts/:scout_id/earnings",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"scouts",
								":scout_id",
								"earnings"
							],
							"variable": [
								{
									"key": "scout_id",
									"value": "YOUR_SCOUT_ID_HERE",
									"description": "UUID of the scout (from register response)"
								}
							]
						},
						"description": "Get scout earnings with breakdown. Shows ₹10 per recruit's first sale."
					}
				},
				{
					"name": "Get Leaderboard",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:3000/scouts/leaderboard?limit=10",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"scouts",
								"leaderboard"
							],
							"query": [
								{
									"key": "limit",
									"value": "10",
									"description": "Number of top scouts to return (default: 10)"
								}
							]
						},
						"description": "Get top scouts by earnings. Public endpoint (no authentication required)."
					}
				},
				{
					"name": "Request Payout",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"amount_paise\": 1000\n}"
						},
						"url": {
							"raw": "http://localhost:3000/scouts/:scout_id/request-payout",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"scouts",
								":scout_id",
								"request-payout"
							],
							"variable": [
								{
									"key": "scout_id",
									"value": "YOUR_SCOUT_ID_HERE",
									"description": "UUID of the scout (from register response)"
								}
							]
						},
						"description": "Request payout. Leave amount_paise empty or omit to request all earnings."
					}
				}
			]
		},
		{
			"name": "Messages",
			"item": [
				{
					"name": "Send Message",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"recipient_id\": \"2\",\n  \"content\": \"Hi! Is this item still available?\",\n  \"listing_id\": \"YOUR_LISTING_ID_HERE\"\n}"
						},
						"url": {
							"raw": "http://localhost:3000/messages",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"messages"
							]
						},
						"description": "Send a message to another user. listing_id and order_id are optional."
					}
				},
				{
					"name": "Get All Conversations",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/messages/conversations",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"messages",
								"conversations"
							]
						},
						"description": "Get list of all users you've messaged with, including last message and unread count."
					}
				},
				{
					"name": "Get Conversation with User",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/messages/conversations/:userId?page=1&limit=50",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"messages",
								"conversations",
								":userId"
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"description": "Page number (default: 1)"
								},
								{
									"key": "limit",
									"value": "50",
									"description": "Messages per page (default: 50)"
								},
								{
									"key": "listing_id",
									"value": "",
									"description": "Filter by listing (optional)",
									"disabled": true
								},
								{
									"key": "order_id",
									"value": "",
									"description": "Filter by order (optional)",
									"disabled": true
								}
							],
							"variable": [
								{
									"key": "userId",
									"value": "2",
									"description": "User ID of the other person in the conversation"
								}
							]
						},
						"description": "Get conversation history with a specific user. Messages are automatically marked as read when fetched."
					}
				},
				{
					"name": "Get Unread Count",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/messages/unread-count",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"messages",
								"unread-count"
							]
						},
						"description": "Get total number of unread messages. Useful for notification badges."
					}
				},
				{
					"name": "Mark Messages as Read",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_TOKEN_HERE",
								"description": "JWT token from login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"message_ids\": [\"message-uuid-1\", \"message-uuid-2\"]\n}"
						},
						"url": {
							"raw": "http://localhost:3000/messages/mark-read",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"messages",
								"mark-read"
							]
						},
						"description": "Manually mark specific messages as read."
					}
				}
			]
		},
		{
			"name": "Admin",
			"item": [
				{
					"name": "Create First Admin (Setup)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"admin@university.edu\",\n  \"password\": \"Admin123!\"\n}"
						},
						"url": {
							"raw": "http://localhost:3000/admin/setup/first-admin",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"admin",
								"setup",
								"first-admin"
							]
						},
						"description": "Create the first admin user. This endpoint works WITHOUT authentication and can only be used if no admin exists. After creating the first admin, use the regular admin endpoints to create more admins."
					}
				},
				{
					"name": "List Users",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_ADMIN_TOKEN_HERE",
								"description": "JWT token from admin user login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/admin/users?page=1&limit=20",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"admin",
								"users"
							],
							"query": [
								{
									"key": "search",
									"value": "",
									"description": "Search in name or email (optional)",
									"disabled": true
								},
								{
									"key": "banned",
									"value": "false",
									"description": "Filter by banned status (optional)",
									"disabled": true
								},
								{
									"key": "role",
									"value": "user",
									"description": "Filter by role: user or admin (optional)",
									"disabled": true
								},
								{
									"key": "page",
									"value": "1",
									"description": "Page number (default: 1)"
								},
								{
									"key": "limit",
									"value": "20",
									"description": "Users per page (default: 20)"
								}
							]
						},
						"description": "List all users with filters and pagination. Requires admin role."
					}
				},
				{
					"name": "Get User Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_ADMIN_TOKEN_HERE",
								"description": "JWT token from admin user login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/admin/users/:id",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"admin",
								"users",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "User ID"
								}
							]
						},
						"description": "Get detailed information about a specific user. Requires admin role."
					}
				},
				{
					"name": "Ban User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_ADMIN_TOKEN_HERE",
								"description": "JWT token from admin user login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"reason\": \"Violation of terms of service - spam listings\"\n}"
						},
						"url": {
							"raw": "http://localhost:3000/admin/users/:id/ban",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"admin",
								"users",
								":id",
								"ban"
							],
							"variable": [
								{
									"key": "id",
									"value": "2",
									"description": "User ID to ban"
								}
							]
						},
						"description": "Ban a user with a reason. Cannot ban yourself or other admins. Requires admin role."
					}
				},
				{
					"name": "Unban User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_ADMIN_TOKEN_HERE",
								"description": "JWT token from admin user login"
							}
						],
						"url": {
							"raw": "http://localhost:3000/admin/users/:id/unban",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"admin",
								"users",
								":id",
								"unban"
							],
							"variable": [
								{
									"key": "id",
									"value": "2",
									"description": "User ID to unban"
								}
							]
						},
						"description": "Unban a previously banned user. Requires admin role."
					}
				},
				{
					"name": "Update User Role",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer YOUR_ADMIN_TOKEN_HERE",
								"description": "JWT token from admin user login"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"role\": \"admin\"\n}"
						},
						"url": {
							"raw": "http://localhost:3000/admin/users/:id/role",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"admin",
								"users",
								":id",
								"role"
							],
							"variable": [
								{
									"key": "id",
									"value": "3",
									"description": "User ID to update role"
								}
							]
						},
						"description": "Promote user to admin or demote admin to user. Cannot change your own role. Requires admin role."
					}
				}
			]
		}
	]
}

